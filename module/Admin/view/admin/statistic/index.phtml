<?php
/* pizza would be really nice */

$title = 'ERS Statistics';
$this->headTitle($title);
?>
<h1><?php echo $this->escapeHtml($title); ?></h1>

<div class="row">
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading">Orders</div>
            <table class="table table-striped">
                <tbody>
                    <tr>
                        <th>count</th>
                        <th>total sum</th>
                        <th>payment fees</th>
                    </tr>
                    <tr>
                        <td><?php echo $order_data['ordercount']; ?></td>
                        <td><?php echo $this->currencyFormat($order_data['totalsum'], 'EUR', null, 'de_DE'); ?></td>
                        <td><?php echo $this->currencyFormat($order_data['paymentfees'], 'EUR', null, 'de_DE'); ?></td>
                    </tr>
                    <tr>
                        <td>fast:</td>
                        <td><?php echo $this->currencyFormat($order_data['totalsum_fast'], 'EUR', null, 'de_DE'); ?></td>
                        <td><?php echo $this->currencyFormat($order_data['paymentfees_fast'], 'EUR', null, 'de_DE'); ?></td>
                    </tr>
                    <tr>
                        <td colspan="3"><pre><?php var_dump($order_data); ?></pre></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="panel panel-default">
            <div class="panel-heading">Participants</div>
            <table class="table table-striped">
                <?php foreach($participant_stats as $key => $value): ?>
                <tr>
                    <th><?php echo $key; ?></th>
                    <td><?php echo $value; ?></td>
                </tr>
                <?php endforeach; ?>
            </table>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">Products</div>
            <table class="table table-striped">
                <?php foreach($products as $product): ?>
                <tr>
                    <th><?php echo $product->getName(); ?></th>
                    <td><?php echo $product->getItems()->count(); ?></td>
                </tr>
                <?php endforeach; ?>
            </table>
        </div>
    </div>
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading">Product Variants</div>
            <div class="panel-body">
                <?php foreach($variants as $variant): ?>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <?php echo $variant->getStatsname() ?: $variant->getName(); ?>
                        </div>
                            <table class="table table-striped">
                            <?php foreach($variant->getProductVariantValues() as $value): ?>
                                <tr>
                                    <th><?php echo $value->getValue(); ?></th>
                                    <td><?php echo $variant_stats[$variant->getId()][$value->getId()]; ?></td>
                                </tr>
                            <?php endforeach; ?>
                            </table>
                    </div>
                <?php endforeach; ?>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading">Orders by payment types</div>
            <table class="table table-striped">
                <tbody>
                    <?php foreach($paymenttypes as $paymenttype): ?>
                        <tr>
                            <th><?php echo $paymenttype->getName(); ?></th>
                            <td><?php echo $paymenttype->getOrders()->count(); ?></td>
                        </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>
        </div>
    </div>
</div>