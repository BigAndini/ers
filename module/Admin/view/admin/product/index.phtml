<?php

$title = 'Product Overview';
$this->headTitle($title);
?>
<h1><?php echo $this->escapeHtml($title); ?></h1>
<p>
    <a href="<?php echo $this->url('admin/product', array('action'=>'add'));?>">Add Product</a>
</p>

<table class="table">
    <tr>
        <th>Order</th>
        <th>Name</th>
        <th>Variant</th>
        <th colspan="2">Base Price</th>
        <th>&nbsp;</th>
        <th>&nbsp;</th>
    </tr>
<?php foreach ($products as $product) : ?>
    <tr>
        <td><?php echo $this->escapeHtml($product->getOrder());?></td>
        <td><?php 
            echo $this->escapeHtml($product->getName());
            if($product->getPersonalized()) : ?> 
                <!--<img src="/img/icons/32px/user.png" alt="(personalized)" title="This product needs to be linked to a user" />-->
                <i class="fa fa-user"></i>
            <?php endif;?>
        </td>
        <td>
            <a href="<?php echo $this->url('admin/product-variant', array('action'=>'add', 'id' => $product->getId()));?>"><?php echo $this->translate('Add Product Variant'); ?></a>
            <?php foreach($product->getProductVariants() as $variant) : ?>
            <p>
                <span><?php echo $variant->getName(); ?></span>
                <a href="<?php echo $this->url('admin/product-variant', array('action' => 'edit', 'id' => $variant->getId()));?>">edit</a>
                <a href="<?php echo $this->url('admin/product-variant', array('action' => 'copy', 'id' => $variant->getId()));?>">copy</a>
                <a href="<?php echo $this->url('admin/product-variant', array('action' => 'delete', 'id' => $variant->getId()));?>">delete</a></p>
            <?php endforeach; ?>
        </td>
        <td colspan="2">
            <a href="<?php echo $this->url('admin/product-price', array('action'=>'add', 'id' => $product->getId()));?>"><?php echo $this->translate('Add Product Price'); ?></a>
            <?php foreach($product->getProductPrices() as $price) : ?>
            <p>
                <span>
                    <?php echo $this->currencyFormat($price->getCharge(), 'EUR', null, 'de_DE'); ?>
                    <?php if($price->getDeadlineId() != null) : ?>
                    (<?php echo $price->getDeadline()->getDeadline()->format('Y-m-d H:i:s'); ?>)
                    <?php else : ?>
                    (no Deadline)
                    <?php endif; ?>
                    
                </span>
                <a href="<?php echo $this->url('admin/product-price', array('action' => 'edit', 'id' => $price->getId()));?>">edit</a>
                <a href="<?php echo $this->url('admin/product-price', array('action' => 'delete', 'id' => $price->getId()));?>">delete</a></p>
            <?php endforeach; ?>
        </td>
        <td>&nbsp;</td>
        <td>
            <a href="<?php echo $this->url('admin/product', array('action' => 'view', 'id' => $product->getId()));?>"><?php echo $this->translate('Detail'); ?></a>
            <a href="<?php echo $this->url('admin/product', array('action' => 'edit', 'id' => $product->getId()));?>"><?php echo $this->translate('Edit'); ?></a>
            <a href="<?php echo $this->url('admin/product', array('action' => 'copy', 'id' => $product->getId()));?>"><?php echo $this->translate('Copy'); ?></a>
            <a href="<?php echo $this->url('admin/product', array('action' => 'delete', 'id' => $product->getId()));?>"><?php echo $this->translate('Delete'); ?></a>
        </td>
    </tr>
<?php endforeach; ?>
</table>