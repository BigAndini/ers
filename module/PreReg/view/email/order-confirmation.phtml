<?php
    $orderLink = '<a href="' . 
            $this->url('order', array(
                'action' => 'view',
                'hashkey' => $order->getHashKey()
            ), array('force_canonical' => true)) . 
            '">' . $this->translate('your order') . '</a>';
    $termsLink = '<a href="' . 
            $this->url('info',
                array('action' => 'terms'),
                array('force_canonical' => true)
            ).'">' . $this->translate('terms and conditions') . '</a>';
    $orderDate = $order->getCreated()->format('d.m.Y');
    $orderId = '<b>'.$order->getCode()->getValue().'</b>';
    $preregMail = '<a href=\'mailto:'.$this->setting('ers.prereg_mail').'\'>'.$this->setting('ers.prereg_mail').'</a>';
    $infoMail = '<a href=\'mailto:'.$this->setting('ers.info_mail').'\'>'.$this->setting('ers.info_mail').'</a>';
    $website = '<a href=\''.$this->setting('ers.website').'\'>'.$this->setting('ers.website').'</a>';
?>

<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
</head>
<body>
<div style="font-family: sans-serif;">
    <p><?php printf($this->translate('Dear %s %s,'), $order->getBuyer()->getFirstname(), $order->getBuyer()->getSurname()); ?></p>

    <p>
        
        <?php 
        
        printf($this->translate('This is the summary for %s from %s with the order ID %s.'),
                $orderLink,
                $orderDate,
                $orderId); ?>
    </p>
    
    <p><?php printf($this->translate('Your order is not confirmed until we receive your payment. Once we receive payment you will be sent your E-ticket, please allow 14 days for money transfer and processing')); ?></p>

    <!--<p>
        To receive this email in another language you can visit the <a href="<?php echo $this->url('order', array(
            'action' => 'email',
            'hashkey' => $order->getHashKey()
        ), array('force_canonical' => true)); ?>">resend email link</a>.
    </p>-->

    <p>Danke für deine Anmeldung zur <?php echo $this->setting('ers.name_with_year')?>.</p>

    <p><?php printf($this->translate('You\'ve chosen %s as payment method.'), $order->getPaymentType()->getName()); ?></p>

    <?php
    $paymenttype = $order->getPaymentType();
    if($paymenttype->getType() == 'sepa'): ?>

        <p><?php echo $this->translate('To complete your order, we need to receive your bank transfer within 7 days.'); ?></p>

        <?php echo $this->partial('partial/sepa-banktransfer-info.phtml', array('order' => $order)); ?>

        <p><?php printf($this->translate('To see if we have already received your payment, you can visit the following link: %s'), $orderLink); ?></p>

    <?php elseif($paymenttype->getType() == 'ukbt'): ?>

        <p><?php echo $this->translate('To complete your order, we need to receive your bank transfer within 14 days.'); ?></p>

        <?php echo $this->partial('partial/ukbt-banktransfer-info.phtml', array('order' => $order)); ?>

        <p><?php printf($this->translate('To see if we have already received your payment, you can visit the following link: %s'), $orderLink); ?></p>
    <?php elseif($paymenttype->getType() == 'cheque'): ?>

        <p>The conversation rate Euro to Pounds for cheques is set to 0.8 -
            this means that you need to multiply the price with 0.8, i.e.
            120 EUR --> 96 GBP.</p>
        <p>​​Please make cheques payable to: <strong>European Juggling
            Association</strong>.</p>
        <p>Your order amount in GBP is: <strong>
            <?php
            $pound = ($order->getSum()*0.8);
            echo $this->currencyFormat($pound, 'GBP', null, 'en_GB');
            ?>
                </strong></p>
        <p>Please send:</p>
        <ul>
            <li>Cheques (amount in GBP, price calculated from Euro-price * 0,8 )</li>
            <li>your name</li>
            <li>order ID <?php echo $order->getCode()->getValue(); ?></li>
            <li>to the address of the UK country-rep:<br /><br />
                Ron Trickett<br />
                14 Peterborough Road<br />
                Newton Hall<br />
                Durham<br />
                DH1 5QX<br />
            </li>
        </ul>
        <p>If you ordered a discounted ticket (phase 1 or phase 2), please
            make sure that your cheque is received within 14 days after the
            end of this phase (i.e. 14th of May / 14th of July).</p>
        <p>To see if we have already received your payment, you can visit the following link:
        <a href="<?php echo $this->url('order', array(
            'action' => 'view',
            'hashkey' => $order->getHashKey()
        ), array('force_canonical' => true)); ?>">Your order details</a></p>

    <?php elseif($paymenttype->getType() == 'creditcard'): ?>

        <p>We should have received your payment by now.</br>
            In case your payment was not successful, you can restart your
            credit card payment via the following link:
            <a href="<?php echo $this->url('order', array(
                'action' => 'view',
                'hashkey' => $order->getHashKey()
            ), array('force_canonical' => true)); ?>">Your order details</a></p>

    <?php elseif($paymenttype->getType() == 'paypal'): ?>

        <p><?php echo $this->translate('We should have received your payment by now.'); ?><br>
            <?php echo $this->translate('In case your payment was not successful, you can restart your
            PayPal payment via the following link:'); ?>
            <a href="<?php echo $this->url('order', array(
                'action' => 'view',
                'hashkey' => $order->getHashKey()
            ), array('force_canonical' => true)); ?>"><?php echo $this->translate('Your order details'); ?></a></p>

    <?php endif; ?>

    <p>
        <?php printf($this->translate('Please consider our general %s. To be able to read the document, you need to install Adobe Acrobat Reader, which you can download here:'), $termsLink); ?>
        <a href="http://get.adobe.com/reader">http://get.adobe.com/reader</a>
    </p>

    <p>
        <?php printf($this->translate('Your E-Tickets and further information concerning the %s will be delivered in another email as soon as we start distributing the E-Tickets and your payment has been confirmed.'), $this->setting('ers.name_with_number')); ?>
    </p>
    
    <p><?php $this->translate('Regards,'); ?></p>

    <p>Euer Berliner Convention Orga-Team</p>

    <hr>
    <p>
        <?php printf($this->translate('You purchased the following items (ordered by %s %s):'), $order->getBuyer()->getFirstname(), $order->getBuyer()->getSurname()); ?>
    </p>

    <?php echo $this->partial('partial/order-info.phtml', array('order' => $order)); ?>

    <div style="width: 100%;
            text-align: center;
            padding: 1em;
            background-color: #eeeeee;">
                Diese E-Mail wurde dir im Namen der <?php echo $this->setting('ers.name_with_year'); ?> vom Event Registration System (ERS) geschickt, 
        das vom Circulum e.V. betrieben wird.<br />
        Wenn du Fragen zu unserer Voranmeldung hast, kontaktiere uns bitte unter <a href="mailto:anmeldung@circulum.de">anmeldung@circulum.de</a><br />
        Für mehr Informationen zur <?php echo $this->setting('ers.name_with_year'); ?>, besuche <a href="http://www.circulum.de">http://www.circulum.de</a>.
    </div>
</div>
</body>
</html>
