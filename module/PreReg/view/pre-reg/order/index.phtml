<?php
 // module/RegistrationSystem/view/registration-system/admin/index.phtml:

 $title = 'My Shopping Cart';
 $this->headTitle($title);
 ?>

 <h1><?php echo $this->escapeHtml($title); ?></h1>
 
 <!-- 
 * Insert field for hasPersonalizedTickets to show belongs to column or not.
 -->
<div class="order-steps">
    <div class="order-step active">1: <a href="<?php echo $this->url('order'); ?>">My cart</a></div>
    <div class="order-step">2: <a href="<?php echo $this->url('order', array('action' => 'register')); ?>">Register</a></div>
    <div class="order-step">3: <a href="<?php echo $this->url('order', array('action' => 'payment')); ?>">Payment</a></div>
    <div class="order-step">4: <a href="<?php echo $this->url('order', array('action' => 'checkout')); ?>">Checkout</a></div>
</div>
<div class="clear-both"></div>
<div class="checkout">
    <a class="btn btn-lg btn-primary" href="<?php echo $this->url('order', array('action' => 'register')) ?>">Checkout this Cart</a>
</div>
<div>
    <?php if(count($packages) == 1 && count($packages[0]->getItems()) == 0): ?>
        <h2>Your Shopping Cart is empty</h2>
    <?php else: ?>
    <table class="table table-bordered">
        <tr>
            <th class="col-description">Description</th>
            <th class="col-belongsto">belongs to</th>
            <!--<th>amount</th>-->
            <th>price</th>
            <th class="col-tools"></th>
        </tr>
        <?php 
        $sum = 0;
        foreach ($packages as $package) : 
            $participant = $package->getParticipant();
        ?>
        <?php 
            if($participant->getPrename() == '' && $participant->getSurname() == '') :
                $participant = 'unassigned items';
            else:
                $participant = $participant->getPrename().' '.$participant->getSurname();
            endif;
        ?>
        
            <?php if(count($package->getItems()) != 0 && $participant != 'unassigned items'): ?>
                <?php foreach ($package->getItems() as $item) : ?>
        <tr>
            <td><?php echo $item->getName(); ?></td>
            <td><?php echo $participant; ?></td>
            <td class="col-price"><?php 
                echo $item->getPrice()->charge;
                $sum += $item->getPrice()->charge;
            ?> €</td>
            <td><a href="#">edit</a><a href="#">delete</a></td>
        </tr>
                <?php endforeach; ?>    
            <?php endif; ?>
        <?php endforeach; ?>
        <tr>
            <td></td>
            <td class="sum-desc">Sum:</td>
            <td class="sum-price"><?php echo $sum; ?> €</td>
            <td></td>
        </tr>
    </table>
    <?php endif; ?>
 </div>
 <div class="clear-both"></div>
 <div class="checkout">
     <a class="btn btn-lg btn-primary" href="<?php echo $this->url('order', array('action' => 'register')) ?>">Checkout this Cart</a>
 </div>